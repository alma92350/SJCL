<!doctype html>
<head>
  <title>My SJCL Wrapper v2</title>
  <script type="text/javascript" src="sjcl.js"></script>
</head>
<body>
    	<p id="top"></p>
	<br>
    
<script>

/* Encrypt a message */
function doEncrypt(password,plaintext) {
  var rp = {}, ct, p;
  
  p = { //adata:"",
        //iter:10000,
        //mode:"ccm",
        ts:64,
        ks:256
        };

  ct = sjcl.encrypt(password, plaintext, p, rp);
  return ct;
}

/* Decrypt a message */
function doDecrypt(password, ciphertext) {
  var aes, rp = {}, outstring="";

  if (ciphertext.match("{")) {
    /* it's jsonized */
    try {
      outstring = sjcl.decrypt(password, ciphertext, {}, rp);
    } catch(e) {
      outstring= "Can't decrypt: " + e ;
      return outstring;
    }
    return (outstring);
	  
  } else {
	    outstring = "It's not jsonized";
	    return outstring;
    }
}
   
    /////////////////
    //// Receiver
    ////////////////
    function myUriEncode(str){
        str = str.replace('%', "%25");
	    return str.replace('&', "%26");
    }
    
    function myUriDecode(str){
        str = str.replace('%26', "&");
	    return str.replace('%25', "%");
    }
	
function clear(){
	document.getElementById("top").innerHTML = "";
}
</script>
    
</body>
</html>
